[phases.setup]
nixPkgs = ['nodejs_22']

[phases.install]
cmds = ['npm ci --prefer-offline --no-audit']

[phases.build]
cmds = [
  'echo "=== Verificando .env.production ==="',
  'cat .env.production',
  'echo "=== Limpiando cache ==="',
  'rm -rf node_modules/.vite dist .vite',
  'echo "=== Building ==="',
  'npm run build',
  'echo "=== Build completado ==="',
  'ls -la dist/'
]

[start]
cmd = 'npx serve dist -l $PORT -s'
